<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">lib/formatColumn.js | API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  <a href="./manual/index.html" data-ice="manualHeaderLink">Manual</a>
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <a data-ice="repoURL" href="https://github.com/nashdot/accounting-js" class="repo-url-github">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-formatColumn">formatColumn</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-formatMoney">formatMoney</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-formatNumber">formatNumber</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-toFixed">toFixed</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-unformat">unformat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-settings">settings</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-Settings">Settings</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">lib/formatColumn.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import objectAssign from &apos;object-assign&apos;;
import isString from &apos;is-string&apos;;

import checkCurrencyFormat from &apos;./internal/checkCurrencyFormat&apos;;
import settings from &apos;./settings&apos;;
import formatNumber from &apos;./formatNumber&apos;;
import unformat from &apos;./unformat&apos;;

/**
 * Format a list of numbers into an accounting column, padding with whitespace
 * to line up currency symbols, thousand separators and decimals places.
 *
 * Returns array of accouting-formatted number strings of same length.
 *
 * NB: `white-space:pre` CSS rule is required on the list container to prevent
 * browsers from collapsing the whitespace in the output strings.
 *
 * **Usage:**
 *
 * ```js
 * formatColumn([123.5, 3456.49, 777888.99, 12345678, -5432], { symbol: &quot;$ &quot; });
 * ```
 *
 * @access public
 * @param {Array&lt;Number&gt;} list - Array of numbers to format
 * @param {Object} [opts={}] - Object containing all the options of the method
 * @return {Array&lt;String&gt;} - Array of accouting-formatted number strings of same length
 */
function formatColumn(list, opts = {}) {
  if (!list) return [];

  // Build options object from second param (if object) or all params, extending defaults
  opts = objectAssign({},
    settings,
    opts
  );

  // Check format (returns object with pos, neg and zero), only need pos for now
  const formats = checkCurrencyFormat(opts.format);

  // Whether to pad at start of string or after currency symbol
  const padAfterSymbol = formats.pos.indexOf(&apos;%s&apos;) &lt; formats.pos.indexOf(&apos;%v&apos;);

  // Store value for the length of the longest string in the column
  let maxLength = 0;

  // Format the list according to options, store the length of the longest string
  const formatted = list.map((val) =&gt; {
    if (Array.isArray(val)) {
      // Recursively format columns if list is a multi-dimensional array
      return formatColumn(val, opts);
    }
    // Clean up the value
    val = unformat(val, opts.decimal);

    // Choose which format to use for this value (pos, neg or zero)
    let useFormat;

    if (val &gt; 0) {
      useFormat = formats.pos;
    } else if (val &lt; 0) {
      useFormat = formats.neg;
    } else {
      useFormat = formats.zero;
    }

    // Format this value, push into formatted list and save the length
    const fVal = useFormat
      .replace(&apos;%s&apos;, opts.symbol)
      .replace(&apos;%v&apos;, formatNumber(Math.abs(val), opts));

    if (fVal.length &gt; maxLength) {
      maxLength = fVal.length;
    }

    return fVal;
  });

  // Pad each number in the list and send back the column of numbers
  return formatted.map((val) =&gt; {
    // Only if this is a string (not a nested array, which would have already been padded)
    if (isString(val) &amp;&amp; val.length &lt; maxLength) {
      // Depending on symbol position, pad after symbol or at index 0
      return padAfterSymbol ?
        val.replace(opts.symbol, opts.symbol + (new Array(maxLength - val.length + 1).join(&apos; &apos;))) :
        (new Array(maxLength - val.length + 1).join(&apos; &apos;)) + val;
    }
    return val;
  });
}

export default formatColumn;
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.4.5)</span></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
